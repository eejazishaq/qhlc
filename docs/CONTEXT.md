# üìò QHLC Web Portal (KSA) ‚Äî Developer Documentation

**Version:** 0.1  
**Date:** 2025-06-28  
**Prepared By:** Eejaz Ishaq

---

## üß≠ Table of Contents

1. [Project Overview](#1-project-overview)  
2. [Technology Stack](#2-technology-stack)  
3. [System Architecture](#3-system-architecture)  
4. [User Roles & Access Levels](#4-user-roles--access-levels)  
5. [App Flow](#5-app-flow)  
6. [Modules & Pages](#6-modules--pages)  
7. [Registration Flow](#7-registration-flow)  
8. [Database Structure](#8-database-structure)  
9. [Authentication & Security](#9-authentication--security)  
10. [UI/UX Design Conventions](#10-uiux-design-conventions)  
11. [Deployment Plan](#11-deployment-plan)  
12. [Non-Functional Requirements](#12-non-functional-requirements)  

---

## 1. üìñ Project Overview

QHLC Web Portal is a country-wide web platform for Quranic learning and exam management in Saudi Arabia. It offers:

- Role-based login (User, Coordinator, Convener, Admin)
- Exam registration and evaluation
- Real-time reporting
- Admin tools for content, schedule, and report management
- Arabic/English/Malayalam language support

---

## 2. üõ† Technology Stack

| Layer         | Technology                         |
|---------------|------------------------------------|
| Frontend      | Next.js, Tailwind CSS              |
| PWA           | Next.js PWA, Workbox               |
| Authentication| Supabase Auth (email/password)     |
| Backend       | Supabase Auto-generated REST APIs  |
| Database      | Supabase PostgreSQL                |
| Storage       | Supabase Buckets                   |
| Hosting       | Vercel or Netlify                  |
| Domain & DNS  | Cloudflare                         |

---

## 3. üß± System Architecture

The system follows a modern web architecture with:

- **Frontend**: Next.js application with server-side rendering
- **Backend**: Supabase provides authentication, database, and storage
- **Database**: PostgreSQL with Row-Level Security (RLS)
- **Authentication**: JWT-based sessions via Supabase Auth
- **File Storage**: Supabase Storage buckets for certificates and media
- **Deployment**: Static hosting with serverless functions

---

## 4. üßë‚Äçüíº User Roles & Access Levels

| Role           | Description                                      |
|----------------|--------------------------------------------------|
| User           | Registers, views profile, takes mock/exams      |
| Coordinator    | Manages attendance, book, and progress           |
| Convener       | Regional center oversight                        |
| Exam Admin     | Exam management, questions, evaluations          |
| Super Admin    | Full system configuration, user/resource control |

---

## 5. üîÑ App Flow

### üîê Authentication

- Email/password registration/login via Supabase Auth
- RLS (Row-Level Security) ensures role-based access
- User is redirected based on role after login

### üìá Role-based Dashboards

- After login, route users to respective dashboards
- Fetch profile data using Supabase client-side session, so user can change their profile details
- Conditionally render components by `user_type`

### üì• Data Flow

- Public ‚Üí Registration ‚Üí Auth SignUp + Profile Entry
- Profile ‚Üí Inserted with dependent Area/Center selection
- Exams ‚Üí Auto-assigned or manually scheduled
- Answers ‚Üí Evaluated by admin or auto-evaluated
- Reports ‚Üí Generated per role (Coordinator, Convener, Admin)

---

## 6. üìÇ Modules & Pages

### 6.1 Public Pages

- `/` - Landing Page
- `/resources` - Static/Downloadable content
- `/gallery` - Image gallery from Supabase bucket
- `/downloads` - PDFs, videos
- `/contact` - Contact form / email trigger
- `/login`, `/register` - Auth pages

### 6.2 User Dashboard (`/dashboard/user`)

- **Dashboard**: Summary of exams, certificates
- **Profile**: View/edit personal details
- **Exam**: Start or schedule exam
- **Mock Exams**: Practice mode
- **Exam History**: Previous results
- **Certificates**: View/download PDFs

### 6.3 Coordinator Dashboard (`/dashboard/coordinator`)

- **Attendance**: Mark/view user presence
- **Progress**: Quran memorization/tracking
- **Books**: Distribute & track book handovers

### 6.4 Convener Dashboard (`/dashboard/convener`)

- **Center Summary**: Overview of all centers in region
- **Reports**: Generate attendance, book, and progress reports

### 6.5 Admin Panel (`/admin`)

- **Users**: Manage users by role and access
- **Question Bank**: Create, edit, delete questions
- **Exam Schedule**: Add exams, assign to users
- **Evaluation**: Review user answers, grade
- **Transfer Tool**: Move users between centers
- **Resources**: Upload PDFs, videos
- **Reports**: Export reports (CSV, PDF)

---

## 7. üìù Registration Flow

### Adult Registration

| Field            | Required | Notes                        |
|------------------|----------|------------------------------|
| Full Name        | ‚úÖ       |                              |
| Mobile           | ‚úÖ       | Unique check                 |
| WhatsApp No      | ‚úÖ       | Optional                     |
| Gender           | ‚úÖ       | Enum (Male/Female)           |
| Area             | ‚úÖ       | Selected based on Region     |
| Exam Center      | ‚úÖ       | Auto-loaded based on Area    |
| Email            | ‚úÖ       | Supabase Auth email          |
| Password         | ‚úÖ       | Supabase Auth password       |

### Child Registration (Additional Fields)

| Field           | Required |
|-----------------|----------|
| Father Name     | ‚úÖ       |
| Date of Birth   | ‚úÖ       |
| Iqama Number    | ‚úÖ       |

### Dependent Dropdowns

1. **Country ‚Üí Region ‚Üí Area ‚Üí Exam Center** (linked FK lookups)
2. On registration, profile insert + Supabase user creation
3. Serial number: `QHLC‚Äì<5-digit ID>` auto-generated post insert

---

## 8. üóÉÔ∏è Database Structure

### Complete Database Schema

#### Core Tables

**`users` (Supabase Auth)**
| Column         | Type      | Description               |
|----------------|-----------|---------------------------|
| id             | UUID      | Primary Key (Supabase)    |
| email          | text      | Unique email address      |
| email_confirmed_at | timestamp | Email verification time |
| created_at     | timestamp | Account creation time     |
| updated_at     | timestamp | Last update time          |

**`profiles`**
| Column         | Type      | Description               |
|----------------|-----------|---------------------------|
| id             | UUID      | FK to `users.id`          |
| full_name      | text      | User's full name          |
| mobile         | text      | Mobile number (unique)    |
| whatsapp_no    | text      | Optional WhatsApp number  |
| gender         | enum      | Male/Female               |
| user_type      | enum      | user/coordinator/convener/admin/super_admin |
| area_id        | UUID      | FK to `areas`             |
| center_id      | UUID      | FK to `exam_centers`      |
| father_name    | text      | For child registration    |
| dob            | date      | Date of birth             |
| iqama_number   | text      | Iqama/ID number           |
| serial_number  | text      | Auto-gen: QHLC-XXXXX      |
| profile_image  | text      | URL to profile image      |
| is_active      | boolean   | Default true              |
| created_at     | timestamp | Default NOW()             |
| updated_at     | timestamp | Default NOW()             |

**`countries`**
| Column         | Type      | Description               |
|----------------|-----------|---------------------------|
| id             | UUID      | Primary Key               |
| name           | text      | Country name              |
| code           | text      | Country code (SA)         |
| is_active      | boolean   | Default true              |

**`regions`**
| Column         | Type      | Description               |
|----------------|-----------|---------------------------|
| id             | UUID      | Primary Key               |
| country_id     | UUID      | FK to `countries`         |
| name           | text      | Region name               |
| code           | text      | Region code               |
| is_active      | boolean   | Default true              |

**`areas`**
| Column         | Type      | Description               |
|----------------|-----------|---------------------------|
| id             | UUID      | Primary Key               |
| region_id      | UUID      | FK to `regions`           |
| name           | text      | Area name                 |
| code           | text      | Area code                 |
| is_active      | boolean   | Default true              |

**`exam_centers`**
| Column         | Type      | Description               |
|----------------|-----------|---------------------------|
| id             | UUID      | Primary Key               |
| area_id        | UUID      | FK to `areas`             |
| name           | text      | Center name               |
| address        | text      | Center address            |
| contact_person | text      | Contact person name       |
| contact_phone  | text      | Contact phone number      |
| capacity       | integer   | Maximum capacity          |
| is_active      | boolean   | Default true              |

#### Exam Management Tables

**`exams`**
| Column         | Type      | Description               |
|----------------|-----------|---------------------------|
| id             | UUID      | Primary Key               |
| title          | text      | Exam title                |
| description    | text      | Exam description          |
| duration       | integer   | Duration in minutes       |
| total_marks    | integer   | Total possible marks      |
| passing_marks  | integer   | Minimum marks to pass     |
| exam_type      | enum      | mock/regular/final        |
| status         | enum      | draft/active/inactive     |
| start_date     | timestamp | Exam start date           |
| end_date       | timestamp | Exam end date             |
| created_by     | UUID      | FK to `profiles`          |
| created_at     | timestamp | Default NOW()             |
| updated_at     | timestamp | Default NOW()             |

**`questions`**
| Column         | Type      | Description               |
|----------------|-----------|---------------------------|
| id             | UUID      | Primary Key               |
| exam_id        | UUID      | FK to `exams`             |
| question_text  | text      | The actual question       |
| options        | JSONB     | Multiple choice options   |
| correct_answer | text      | Correct answer            |
| type           | enum      | mcq/truefalse/text        |
| marks          | integer   | Marks for this question   |
| order_number   | integer   | Question order in exam    |
| created_at     | timestamp | Default NOW()             |

**`user_exams`**
| Column         | Type      | Description               |
|----------------|-----------|---------------------------|
| id             | UUID      | Primary Key               |
| user_id        | UUID      | FK to `profiles`          |
| exam_id        | UUID      | FK to `exams`             |
| started_at     | timestamp | Exam start time           |
| submitted_at   | timestamp | Exam submission time      |
| status         | enum      | pending/completed/evaluated |
| total_score    | integer   | Final score               |
| evaluator_id   | UUID      | FK to evaluator           |
| remarks        | text      | Admin remarks             |
| created_at     | timestamp | Default NOW()             |

**`user_answers`**
| Column         | Type      | Description               |
|----------------|-----------|---------------------------|
| id             | UUID      | Primary Key               |
| user_exam_id   | UUID      | FK to `user_exams`        |
| question_id    | UUID      | FK to `questions`         |
| answer_text    | text      | User's answer             |
| is_correct     | boolean   | Auto-evaluated (MCQs)     |
| score_awarded  | integer   | Marks given               |
| evaluated_by   | UUID      | FK to evaluator           |
| created_at     | timestamp | Default NOW()             |

#### Learning Management Tables

**`attendance`**
| Column         | Type      | Description               |
|----------------|-----------|---------------------------|
| id             | UUID      | Primary Key               |
| user_id        | UUID      | FK to `profiles`          |
| center_id      | UUID      | FK to `exam_centers`      |
| date           | date      | Attendance date           |
| status         | enum      | present/absent/late       |
| marked_by      | UUID      | FK to coordinator         |
| remarks        | text      | Optional remarks          |
| created_at     | timestamp | Default NOW()             |

**`progress`**
| Column         | Type      | Description               |
|----------------|-----------|---------------------------|
| id             | UUID      | Primary Key               |
| user_id        | UUID      | FK to `profiles`          |
| surah_number   | integer   | Surah number (1-114)      |
| ayah_start     | integer   | Starting ayah             |
| ayah_end       | integer   | Ending ayah               |
| status         | enum      | memorized/reviewing/learning |
| notes          | text      | Progress notes            |
| updated_by     | UUID      | FK to coordinator         |
| updated_at     | timestamp | Default NOW()             |

**`books`**
| Column         | Type      | Description               |
|----------------|-----------|---------------------------|
| id             | UUID      | Primary Key               |
| user_id        | UUID      | FK to `profiles`          |
| book_type      | enum      | quran/tafseer/other       |
| title          | text      | Book title                |
| issued_date    | date      | When book was issued      |
| return_date    | date      | Expected return date      |
| returned_date  | date      | Actual return date        |
| status         | enum      | issued/returned/overdue   |
| issued_by      | UUID      | FK to coordinator         |
| created_at     | timestamp | Default NOW()             |

#### Content Management Tables

**`resources`**
| Column         | Type      | Description               |
|----------------|-----------|---------------------------|
| id             | UUID      | Primary Key               |
| title          | text      | Resource title            |
| description    | text      | Resource description      |
| file_url       | text      | File URL in storage       |
| file_type      | enum      | pdf/video/audio/image     |
| file_size      | integer   | File size in bytes        |
| category       | enum      | study/exam/certificate    |
| is_public      | boolean   | Publicly accessible       |
| download_count | integer   | Download counter          |
| uploaded_by    | UUID      | FK to admin               |
| created_at     | timestamp | Default NOW()             |

**`gallery`**
| Column         | Type      | Description               |
|----------------|-----------|---------------------------|
| id             | UUID      | Primary Key               |
| title          | text      | Image title               |
| description    | text      | Image description         |
| image_url      | text      | Image URL in storage      |
| category       | enum      | events/activities/other   |
| is_featured    | boolean   | Featured image            |
| uploaded_by    | UUID      | FK to admin               |
| created_at     | timestamp | Default NOW()             |

**`certificates`**
| Column         | Type      | Description               |
|----------------|-----------|---------------------------|
| id             | UUID      | Primary Key               |
| user_id        | UUID      | FK to `profiles`          |
| exam_id        | UUID      | FK to `exams`             |
| certificate_url| text      | PDF URL in storage        |
| issued_date    | date      | Certificate issue date    |
| issued_by      | UUID      | FK to admin               |
| created_at     | timestamp | Default NOW()             |

#### System Tables

**`audit_logs`**
| Column         | Type      | Description               |
|----------------|-----------|---------------------------|
| id             | UUID      | Primary Key               |
| user_id        | UUID      | FK to `profiles`          |
| action         | text      | Action performed          |
| table_name     | text      | Affected table            |
| record_id      | UUID      | Affected record ID        |
| old_values     | JSONB     | Previous values           |
| new_values     | JSONB     | New values                |
| ip_address     | text      | User's IP address         |
| user_agent     | text      | Browser/device info       |
| created_at     | timestamp | Default NOW()             |

**`notifications`**
| Column         | Type      | Description               |
|----------------|-----------|---------------------------|
| id             | UUID      | Primary Key               |
| user_id        | UUID      | FK to `profiles`          |
| title          | text      | Notification title        |
| message        | text      | Notification message      |
| type           | enum      | info/warning/error/success |
| is_read        | boolean   | Read status               |
| action_url     | text      | Optional action URL       |
| created_at     | timestamp | Default NOW()             |

### Database Relationships

```mermaid
erDiagram
    users ||--|| profiles : has
    countries ||--o{ regions : contains
    regions ||--o{ areas : contains
    areas ||--o{ exam_centers : contains
    profiles }o--|| areas : belongs_to
    profiles }o--|| exam_centers : assigned_to
    exams ||--o{ questions : contains
    profiles ||--o{ user_exams : takes
    exams ||--o{ user_exams : assigned_to
    user_exams ||--o{ user_answers : contains
    questions ||--o{ user_answers : answered_by
    profiles ||--o{ attendance : tracked
    exam_centers ||--o{ attendance : hosts
    profiles ||--o{ progress : tracks
    profiles ||--o{ books : borrows
    profiles ||--o{ certificates : receives
    exams ||--o{ certificates : generates
```

---

## 8.1 üìÅ Optimal Folder Structure

```
qhlc/
‚îú‚îÄ‚îÄ public/
‚îÇ   ‚îú‚îÄ‚îÄ icons/                    # PWA icons
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ icon-192x192.png
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ icon-512x512.png
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ apple-touch-icon.png
‚îÇ   ‚îú‚îÄ‚îÄ images/                   # Static images
‚îÇ   ‚îú‚îÄ‚îÄ fonts/                    # Custom fonts
‚îÇ   ‚îî‚îÄ‚îÄ manifest.json             # PWA manifest
‚îÇ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ app/                      # Next.js 13+ App Router
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ (auth)/               # Auth group routes
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ login/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ register/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ layout.tsx
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ (public)/             # Public group routes
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx          # Landing page
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ resources/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ gallery/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ downloads/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ contact/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ layout.tsx
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard/            # Dashboard routes
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user/             # User dashboard
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ profile/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ exams/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mock-exams/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ history/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ certificates/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ coordinator/      # Coordinator dashboard
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ attendance/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ progress/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ books/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ convener/         # Convener dashboard
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ centers/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ reports/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ layout.tsx        # Dashboard layout
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin/                # Admin panel
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ questions/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ exams/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ evaluation/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ transfer/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ resources/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ reports/
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/                  # API routes
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ exams/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ questions/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ attendance/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ progress/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ books/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ resources/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ gallery/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ certificates/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ notifications/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ upload/
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ globals.css           # Global styles
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx            # Root layout
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx              # Root page
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ components/               # Reusable components
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui/                   # Base UI components
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Button.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Input.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Modal.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Table.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Card.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Badge.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Loading.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ forms/                # Form components
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LoginForm.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RegisterForm.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ProfileForm.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ExamForm.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ QuestionForm.tsx
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard/            # Dashboard components
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Sidebar.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Header.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ StatsCard.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RecentActivity.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Navigation.tsx
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ exam/                 # Exam components
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ExamTimer.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ QuestionCard.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AnswerInput.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ProgressBar.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ResultCard.tsx
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin/                # Admin components
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ UserTable.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ QuestionEditor.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ExamScheduler.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ EvaluationPanel.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ReportGenerator.tsx
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mobile/               # Mobile-specific components
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BottomNav.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SwipeableCard.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TouchButton.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ PullToRefresh.tsx
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ layout/               # Layout components
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ Header.tsx
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ Footer.tsx
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ Navigation.tsx
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ Container.tsx
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ lib/                      # Utility libraries
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ supabase/             # Supabase configuration
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ client.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ server.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ storage.ts
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ utils/                # Utility functions
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ validation.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ formatting.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ constants.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ helpers.ts
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hooks/                # Custom React hooks
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useAuth.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useSupabase.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useLocalStorage.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useOffline.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ usePWA.ts
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ types/                # TypeScript types
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ database.ts       # Generated from Supabase
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ auth.ts
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ api.ts
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ common.ts
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ styles/                   # Additional styles
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components.css
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ animations.css
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ themes.css
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ middleware.ts             # Next.js middleware
‚îÇ
‚îú‚îÄ‚îÄ docs/                         # Documentation
‚îÇ   ‚îú‚îÄ‚îÄ CONTEXT.md
‚îÇ   ‚îú‚îÄ‚îÄ API.md
‚îÇ   ‚îú‚îÄ‚îÄ DEPLOYMENT.md
‚îÇ   ‚îî‚îÄ‚îÄ CONTRIBUTING.md
‚îÇ
‚îú‚îÄ‚îÄ scripts/                      # Build and deployment scripts
‚îÇ   ‚îú‚îÄ‚îÄ build.sh
‚îÇ   ‚îú‚îÄ‚îÄ deploy.sh
‚îÇ   ‚îî‚îÄ‚îÄ backup.sh
‚îÇ
‚îú‚îÄ‚îÄ tests/                        # Test files
‚îÇ   ‚îú‚îÄ‚îÄ unit/
‚îÇ   ‚îú‚îÄ‚îÄ integration/
‚îÇ   ‚îî‚îÄ‚îÄ e2e/
‚îÇ
‚îú‚îÄ‚îÄ .env.local                    # Environment variables
‚îú‚îÄ‚îÄ .env.example                  # Environment template
‚îú‚îÄ‚îÄ next.config.js                # Next.js configuration
‚îú‚îÄ‚îÄ tailwind.config.js            # Tailwind CSS configuration
‚îú‚îÄ‚îÄ tsconfig.json                 # TypeScript configuration
‚îú‚îÄ‚îÄ package.json                  # Dependencies
‚îú‚îÄ‚îÄ README.md                     # Project README
‚îî‚îÄ‚îÄ vercel.json                   # Vercel configuration
```

### Key Features of This Structure

**üì± Mobile-First Organization:**
- Separate mobile components in `components/mobile/`
- PWA-specific files in `public/`
- Responsive layouts throughout

**üîê Security & Authentication:**
- Grouped auth routes in `(auth)/`
- Middleware for route protection
- Separate server/client Supabase configs

**üéØ Role-Based Organization:**
- Dashboard routes separated by user type
- Role-specific components
- Conditional rendering based on user type

**üìä Scalable Architecture:**
- Modular component structure
- Reusable UI components
- Type-safe database integration

**üöÄ Performance Optimized:**
- Code splitting by route groups
- Lazy loading components
- PWA service worker integration

---

## 9. üîê Authentication & Security

- JWT sessions via Supabase Auth
- RLS policies to restrict table access:
  - `profiles`: users can only read/update own profile
  - `user_exams`, `answers`: user-restricted
- Admin role check via `user_type` or claim
- Serial number generation via DB trigger or edge function
- Supabase Storage with signed URLs for certificates/files

---

## 10. üé® UI/UX Design Conventions

- **Framework**: Next.js + Tailwind CSS
- **Design**: Clean, responsive layout
- **Theme**: Consistent with Quranic learning environment
- **Navigation**: Sidebar on dashboards
- **Language Toggle**: Malayalam (default) + English
- **Accessibility**: ARIA roles, keyboard support

---

## 10.1 üì± Mobile-First Design & PWA Features

### Mobile-First Approach
- **Primary Focus**: Design for mobile users first, then enhance for desktop
- **Responsive Breakpoints**: 
  - Mobile: 320px - 768px
  - Tablet: 768px - 1024px
  - Desktop: 1024px+
- **Touch-Friendly**: Minimum 44px touch targets for buttons and links
- **Thumb Navigation**: Bottom navigation bar for mobile dashboards
- **Swipe Gestures**: Implement swipe for exam navigation and gallery browsing

### Progressive Web App (PWA) Features

#### Core PWA Requirements
- **Service Worker**: Offline functionality and caching strategies
- **Web App Manifest**: App-like installation experience
- **HTTPS**: Secure connection for all features
- **Responsive Design**: Works on all screen sizes

#### PWA Implementation Details

**Service Worker Strategy:**
- Cache-first for static assets (CSS, JS, images)
- Network-first for API calls with fallback to cached data
- Background sync for offline form submissions
- Push notifications for exam reminders and results

**Web App Manifest:**
```json
{
  "name": "QHLC Web Portal",
  "short_name": "QHLC",
  "description": "Quranic Learning and Exam Management Portal",
  "start_url": "/",
  "display": "standalone",
  "background_color": "#ffffff",
  "theme_color": "#1e40af",
  "icons": [
    {
      "src": "/icons/icon-192x192.png",
      "sizes": "192x192",
      "type": "image/png"
    },
    {
      "src": "/icons/icon-512x512.png",
      "sizes": "512x512",
      "type": "image/png"
    }
  ]
}
```

**Mobile-Specific Features:**
- **Offline Exam Taking**: Download exam content for offline completion
- **Camera Integration**: Photo upload for certificates and documents
- **Biometric Authentication**: Fingerprint/Face ID support where available
- **Haptic Feedback**: Vibration feedback for important actions
- **Pull-to-Refresh**: Native-feeling refresh for content updates

**Performance Optimizations:**
- **Image Optimization**: WebP format with fallbacks
- **Lazy Loading**: Images and components load as needed
- **Code Splitting**: Route-based and component-based splitting
- **Critical CSS**: Inline critical styles for faster rendering
- **Preloading**: Important resources preloaded for better performance

**Installation Experience:**
- **Install Prompt**: Custom install banner for Android/iOS
- **Splash Screen**: Branded loading screen during app startup
- **App Icon**: High-quality icons for home screen installation
- **Deep Linking**: Direct links to specific exam or profile sections

---

## 11. üöÄ Deployment Plan

| Component     | Platform             |
|---------------|----------------------|
| Frontend      | Vercel / Netlify     |
| Backend       | Supabase Cloud       |
| Storage       | Supabase Buckets     |
| Domain        | Cloudflare / Vercel  |
| Backup        | Supabase export via cronjob or CLI |

---

## 12. üß™ Non-Functional Requirements

- ‚úÖ HTTPS enforced
- ‚úÖ Responsive (mobile, tablet, desktop)
- ‚úÖ Load tested for 1000+ concurrent users
- ‚úÖ Form validation (client + server)
- ‚úÖ Secure file access with expiring URLs
- ‚úÖ Daily backup of data + storage
- ‚úÖ Audit logs for admin actions

### Mobile & PWA Requirements
- ‚úÖ PWA installable on Android/iOS devices
- ‚úÖ Offline functionality for core features
- ‚úÖ Touch-optimized interface (44px minimum touch targets)
- ‚úÖ Fast loading (<3 seconds on 3G connection)
- ‚úÖ Push notifications for exam reminders
- ‚úÖ Camera integration for document uploads
- ‚úÖ Biometric authentication support
- ‚úÖ Haptic feedback for user interactions
- ‚úÖ Deep linking support for direct navigation

---

## üìå Developer Notes

- Use `supabase-js` client in React app for DB/Auth/Storage
- Respect role-based access in all API calls
- Use `.env.local` for Supabase keys (no hardcoding)
- Keep all logic for profile/registration modular for reuse
- Version control schema using Supabase Migrations or CLI
- All uploads (certificates, gallery) go to respective buckets

---

## üîß Development Setup

### Prerequisites

- Node.js 18+ 
- npm or yarn
- Supabase CLI
- Git

### Environment Variables

Create `.env.local`:

```bash
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key
```

### Installation

```bash
npm install
npm run dev
```

---

## üìö Additional Resources

- [Supabase Documentation](https://supabase.com/docs)
- [Next.js Documentation](https://nextjs.org/docs)
- [Tailwind CSS Documentation](https://tailwindcss.com/docs)
- [Project Repository](link-to-repo)

---

*Last updated: 2025-06-28*
